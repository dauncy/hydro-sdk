{"version":3,"sources":["../../src/rules/requireJsdoc.js"],"names":["OPTIONS_SCHEMA","additionalProperties","properties","contexts","items","type","publicOnly","oneOf","default","ancestorsOnly","cjs","esm","window","require","ArrowFunctionExpression","ClassDeclaration","ClassExpression","FunctionDeclaration","FunctionExpression","MethodDefinition","getOption","context","baseObject","option","key","_","has","options","getOptions","baseObj","get","Object","keys","reduce","obj","prop","opt","meta","doc","category","description","recommended","url","messages","missingJsDoc","schema","returns","sourceCode","requireOption","checkJsDoc","node","jsDocNode","exemptEmptyFunctions","Boolean","functionParameterNames","jsdocUtils","getFunctionParameterNames","length","hasReturnValue","initModuleExports","initWindow","parseResult","exportParser","parse","ast","exported","isExported","report","messageId","assign","getContextObject","enforcedContexts","includes","parent","value"],"mappings":"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","sourcesContent":["import _ from 'lodash';\nimport iterateJsdoc from '../iterateJsdoc';\nimport jsdocUtils from '../jsdocUtils';\nimport exportParser from '../exportParser';\nimport getJSDocComment from '../eslint/getJSDocComment';\n\nconst OPTIONS_SCHEMA = {\n  additionalProperties: false,\n  properties: {\n    contexts: {\n      items: {\n        type: 'string'\n      },\n      type: 'array'\n    },\n    publicOnly: {\n      oneOf: [\n        {\n          default: false,\n          type: 'boolean'\n        },\n        {\n          additionalProperties: false,\n          default: {},\n          properties: {\n            ancestorsOnly: {\n              type: 'boolean'\n            },\n            cjs: {\n              type: 'boolean'\n            },\n            esm: {\n              type: 'boolean'\n            },\n            window: {\n              type: 'boolean'\n            }\n          },\n          type: 'object'\n        }\n      ]\n    },\n    require: {\n      additionalProperties: false,\n      default: {},\n      properties: {\n        ArrowFunctionExpression: {\n          default: false,\n          type: 'boolean'\n        },\n        ClassDeclaration: {\n          default: false,\n          type: 'boolean'\n        },\n        ClassExpression: {\n          default: false,\n          type: 'boolean'\n        },\n        FunctionDeclaration: {\n          default: true,\n          type: 'boolean'\n        },\n        FunctionExpression: {\n          default: false,\n          type: 'boolean'\n        },\n        MethodDefinition: {\n          default: false,\n          type: 'boolean'\n        }\n      },\n      type: 'object'\n    }\n  },\n  type: 'object'\n};\n\nconst getOption = (context, baseObject, option, key) => {\n  if (!_.has(context, `options[0][${option}][${key}]`)) {\n    return baseObject.properties[key].default;\n  }\n\n  return context.options[0][option][key];\n};\n\nconst getOptions = (context) => {\n  return {\n    publicOnly: ((baseObj) => {\n      const publicOnly = _.get(context, 'options[0].publicOnly');\n      if (!publicOnly) {\n        return false;\n      }\n\n      return Object.keys(baseObj.properties).reduce((obj, prop) => {\n        const opt = getOption(context, baseObj, 'publicOnly', prop);\n        obj[prop] = opt;\n\n        return obj;\n      }, {});\n    })(OPTIONS_SCHEMA.properties.publicOnly.oneOf[1]),\n    require: ((baseObj) => {\n      return Object.keys(baseObj.properties).reduce((obj, prop) => {\n        const opt = getOption(context, baseObj, 'require', prop);\n        obj[prop] = opt;\n\n        return obj;\n      }, {});\n    })(OPTIONS_SCHEMA.properties.require)\n  };\n};\n\nexport default iterateJsdoc(null, {\n  meta: {\n    doc: {\n      category: 'Stylistic Issues',\n      description: 'Require JSDoc comments',\n      recommended: 'true',\n      url: 'https://github.com/gajus/eslint-plugin-jsdoc'\n    },\n\n    messages: {\n      missingJsDoc: 'Missing JSDoc comment.'\n    },\n\n    schema: [\n      OPTIONS_SCHEMA\n    ],\n\n    type: 'suggestion'\n  },\n  returns (context, sourceCode) {\n    const {require: requireOption, publicOnly} = getOptions(context);\n\n    const checkJsDoc = (node) => {\n      const jsDocNode = getJSDocComment(sourceCode, node);\n\n      if (jsDocNode) {\n        return;\n      }\n\n      const exemptEmptyFunctions = Boolean(_.get(context, 'settings.jsdoc.exemptEmptyFunctions'));\n      if (exemptEmptyFunctions) {\n        const functionParameterNames = jsdocUtils.getFunctionParameterNames(node);\n        if (!functionParameterNames.length && !jsdocUtils.hasReturnValue(node, context)) {\n          return;\n        }\n      }\n\n      if (publicOnly) {\n        const opt = {\n          ancestorsOnly: Boolean(_.get(publicOnly, 'ancestorsOnly', false)),\n          esm: Boolean(_.get(publicOnly, 'esm', true)),\n          initModuleExports: Boolean(_.get(publicOnly, 'cjs', true)),\n          initWindow: Boolean(_.get(publicOnly, 'window', false))\n        };\n        const parseResult = exportParser.parse(sourceCode.ast, node, opt);\n        const exported = exportParser.isExported(node, parseResult, opt);\n\n        if (exported && !jsDocNode) {\n          context.report({\n            messageId: 'missingJsDoc',\n            node\n          });\n        }\n      } else {\n        context.report({\n          messageId: 'missingJsDoc',\n          node\n        });\n      }\n    };\n\n    // eslint-disable-next-line fp/no-mutating-assign\n    return Object.assign(\n      jsdocUtils.getContextObject(jsdocUtils.enforcedContexts(context, []), checkJsDoc),\n      {\n        ArrowFunctionExpression (node) {\n          if (!requireOption.ArrowFunctionExpression) {\n            return;\n          }\n\n          if (!['VariableDeclarator', 'ExportDefaultDeclaration'].includes(node.parent.type)) {\n            return;\n          }\n\n          checkJsDoc(node);\n        },\n\n        ClassDeclaration (node) {\n          if (!requireOption.ClassDeclaration) {\n            return;\n          }\n\n          checkJsDoc(node);\n        },\n\n        ClassExpression (node) {\n          if (!requireOption.ClassExpression) {\n            return;\n          }\n\n          checkJsDoc(node);\n        },\n\n        FunctionDeclaration (node) {\n          if (!requireOption.FunctionDeclaration) {\n            return;\n          }\n\n          checkJsDoc(node);\n        },\n\n        FunctionExpression (node) {\n          if (requireOption.MethodDefinition && node.parent.type === 'MethodDefinition') {\n            checkJsDoc(node);\n\n            return;\n          }\n\n          if (!requireOption.FunctionExpression) {\n            return;\n          }\n\n          if (['VariableDeclarator', 'AssignmentExpression', 'ExportDefaultDeclaration'].includes(node.parent.type)) {\n            checkJsDoc(node);\n          } else if (node.parent.type === 'Property' && node === node.parent.value) {\n            checkJsDoc(node);\n          }\n        }\n      }\n    );\n  }\n});\n"],"file":"requireJsdoc.js"}